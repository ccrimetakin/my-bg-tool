import streamlit as st
from rembg import remove, new_session
from PIL import Image
import io

# Professional UI Setup
st.set_page_config(page_title="ChattyFroggy AI Pro", page_icon="üê∏", layout="centered")

st.markdown("""
    <style>
    .stApp { background-color: #0e1117; color: white; }
    .stButton>button { 
        background: linear-gradient(45deg, #2ecc71, #27ae60); 
        color: white; border: none; padding: 10px; border-radius: 8px; width: 100%;
    }
    </style>
    """, unsafe_allow_html=True)

st.title("üê∏ ChattyFroggy HQ AI")
st.write("Bina API key ke Professional Background Removal")

# Model selection for better quality
# 'u2net' general use ke liye best hai, 'u2net_human' sirf logon ke liye
model_option = st.sidebar.selectbox("Model Quality:", ["Standard", "High Quality (Human Only)"])
model_name = "u2net" if model_option == "Standard" else "u2net_human"

uploaded_file = st.file_uploader("Choose a photo...", type=["jpg", "jpeg", "png"])

if uploaded_file:
    img = Image.open(uploaded_file)
    col1, col2 = st.columns(2)
    
    with col1:
        st.info("Original")
        st.image(img, use_container_width=True)

    if st.button("Magic Remove ‚ú®"):
        with st.spinner('AI analysis kar raha hai... isme 10-15 seconds lag sakte hain.'):
            try:
                # Advanced Session for better edge detection
                session = new_session(model_name)
                input_bytes = uploaded_file.getvalue()
                
                # Processing
                output_bytes = remove(input_bytes, session=session)
                output_image = Image.open(io.BytesIO(output_bytes))
                
                with col2:
                    st.success("Ho Gaya!")
                    st.image(output_image, use_container_width=True)
                    st.download_button("Download HQ PNG", output_bytes, "chattyfroggy_pro.png", "image/png")
            
            except Exception as e:
                st.error(f"Error: {e}. Koshish karein ki image size 5MB se kam ho.")

st.divider()
st.caption("Tip: 'High Quality' mode tabhi use karein jab photo mein koi insaan ho.")
